module.exports=function(){const e=require("./paths.js"),{ipcRenderer:t}=require("electron"),{domContentLoadedThen:i,createArrayOf:o,getHostname:r}=require("./util.js"),{onLogin:n,isLoggedIn:s}=require("./login.js"),{getScoreMethods:a,isDone:d,getTheGapOf:c,findScoreMethodsByNames:l}=require("./score.js"),{lock:u,unlock:g,islocked:h}=require("./lock.js"),{TaskList:f,taskTypes:k}=require("./tasks.js"),p=require("./update.js"),m=["oapi.dingtalk.com","login.dingtalk.com","h5.dingtalk.com"];i(async()=>{if(location.href.startsWith(e.loginPage))return n(),void p();if(m.includes(r()))return;if(!s())return void(location.href="https://pc.xuexi.cn/points/login.html?ref=https://www.xuexi.cn/");if(!h()){const e=await a(),[t,i,r,n]=l(e,["阅读文章","观看视频","文章时长","视频时长"]);if(f.tasks=[],d(t)&&d(r)||f.add(k[0]),f.add(...o(k[1],c(t)),...o(k[2],c(r))),d(i)&&d(n)||f.add(k[3]),f.add(...o(k[4],c(i)),...o(k[5],c(n))),0==f.tasks.length)return;u()}const t=f.getAll();f.doAll(t),0==t.length&&g()})}();