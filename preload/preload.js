module.exports=function(){const e=require("./paths.js"),{ipcRenderer:t}=require("electron"),{domContentLoadedThen:o,createArrayOf:i,getHostname:s}=require("./util.js"),{onLogin:n,isLoggedIn:r}=require("./login.js"),{getScoreMethods:a,isDone:d,getTheGapOf:c,findScoreMethodsByNames:l}=require("./score.js"),{lock:u,unlock:g,islocked:h}=require("./lock.js"),{TaskList:k,taskTypes:f}=require("./tasks.js"),p=require("./update.js"),m=["oapi.dingtalk.com","login.dingtalk.com","h5.dingtalk.com"];o(async()=>{if(location.href.startsWith(e.loginPage))return n(),void p();if(m.includes(s()))return;if(!r())return void(location.href="https://pc.xuexi.cn/points/login.html?ref=https://www.xuexi.cn/");if(t.send("save-cookies"),!h()){const e=await a(),[t,o,s,n]=l(e,["阅读文章","观看视频","文章时长","视频时长"]);if(k.tasks=[],d(t)&&d(s)||k.add(f[0]),k.add(...i(f[1],c(t)),...i(f[2],c(s))),d(o)&&d(n)||k.add(f[3]),k.add(...i(f[4],c(o)),...i(f[5],c(n))),0==k.tasks.length)return;u()}const o=k.getAll();k.doAll(o),0==o.length&&g()})}();